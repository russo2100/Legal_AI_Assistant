# –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## ‚úÖ –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ —ç—Ç–∞–ø—ã

### Phase 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [x] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ —Å–æ–∑–¥–∞–Ω–∞
- [x] `requirements.txt` —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- [x] `.env.example` —à–∞–±–ª–æ–Ω
- [x] `pyproject.toml` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [x] `.gitignore`
- [x] –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

### Phase 1: –ë–∞–∑–æ–≤—ã–π –≥—Ä–∞—Ñ LangGraph
- [x] `src/graph/state.py` ‚Äî AgentState (TypedDict)
- [x] `src/graph/nodes.py` ‚Äî 5 —É–∑–ª–æ–≤ (classify, search_norms, search_cases, generate, verify)
- [x] `src/graph/workflow.py` ‚Äî —Å–±–æ—Ä–∫–∞ –≥—Ä–∞—Ñ–∞
- [x] `src/main.py` ‚Äî CLI —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
- [x] `src/utils/logging_config.py` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### Phase 2: RAG-—è–¥—Ä–æ
- [x] `src/rag/embeddings.py` ‚Äî OpenRouterEmbedder —Å retry/backoff
- [x] `src/rag/indexer.py` ‚Äî –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –∫–æ–¥–µ–∫—Å–æ–≤ –≤ pgvector
- [x] `src/rag/retriever.py` ‚Äî –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (BM25 + vector)

### Phase 3: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- [x] `src/tools/kad_parser.py` ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä kad.arbitr.ru
- [x] `src/tools/citation_check.py` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- [x] `src/tools/legal_utils.py` ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### Phase 4: LLM-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [x] `src/llm/client.py` ‚Äî OpenRouterClient —Å retry
- [x] `src/llm/prompts.py` ‚Äî –∑–∞–≥—Ä—É–∑—á–∏–∫ Jinja2 —à–∞–±–ª–æ–Ω–æ–≤
- [x] `src/prompts/classify.j2`
- [x] `src/prompts/generate.j2` (–æ–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è –¢–ó 1.1)
- [x] `src/prompts/verify.j2`

### Phase 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] `src/tests/test_state.py` ‚Äî 4 —Ç–µ—Å—Ç–∞
- [x] `src/tests/test_nodes.py` ‚Äî 10 —Ç–µ—Å—Ç–æ–≤
- [x] `src/tests/test_graph.py` ‚Äî 6 —Ç–µ—Å—Ç–æ–≤
- [x] `src/tests/test_rag.py` ‚Äî 7 —Ç–µ—Å—Ç–æ–≤
- [x] `src/tests/test_embeddings.py` ‚Äî 5 —Ç–µ—Å—Ç–æ–≤
- [x] `src/tests/test_citation.py` ‚Äî 6 —Ç–µ—Å—Ç–æ–≤
- [x] `src/tests/test_e2e.py` ‚Äî 10 E2E —Ç–µ—Å—Ç–æ–≤ + golden set
- [x] `src/tests/golden_set.jsonl` ‚Äî 10 –∫–µ–π—Å–æ–≤
- [x] `pytest.ini` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [x] `src/tests/conftest.py` ‚Äî —Ñ–∏–∫—Å—Ç—É—Ä—ã
- [x] `README.md` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] `docs/architecture.md` ‚Äî —Å—Ö–µ–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- [x] `docs/progress.md` ‚Äî —ç—Ç–æ—Ç —Ñ–∞–π–ª
- [x] `docs/error-log.md` ‚Äî –ª–æ–≥ –æ—à–∏–±–æ–∫
- [x] `docker/docker-compose.yml` ‚Äî PostgreSQL + pgvector
- [x] `docs/langgraph-integration.md` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è LangGraph
- [x] `docs/langgraph-audit.md` ‚Äî –∞—É–¥–∏—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- [x] **–í—Å–µ 49 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç**

## üî¥ –¢–ó 1.1: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —É–∑–ª–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ (2026-02-20)

| –£–∑–µ–ª | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | –°—Ç–∞—Ç—É—Å | –§–∞–π–ª |
|------|------------|--------|------|
| `search_norms` | `src/rag/retriever.py` | ‚úÖ | `src/graph/nodes.py` |
| `search_cases` | `src/tools/kad_parser.py` | ‚úÖ | `src/graph/nodes.py` |
| `generate_answer` | `src/llm/client.py` + `generate.j2` | ‚úÖ | `src/graph/nodes.py` |
| `verify_citation` | `src/tools/citation_check.py` | ‚úÖ | `src/graph/nodes.py` |

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- Graceful degradation: fallback –Ω–∞ –∑–∞–≥–ª—É—à–∫–∏ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- Rate limiting –¥–ª—è kad.arbitr.ru (2—Å –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏)
- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ LLM: 0.1 (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç)
- –î–∏—Å–∫–ª–µ–π–º–µ—Ä –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –≤ –∫–∞–∂–¥–æ–º –æ—Ç–≤–µ—Ç–µ

## üìã –ë—ç–∫–ª–æ–≥

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (MVP)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å PostgreSQL —Å pgvector (Docker)
- [ ] –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–µ–∫—Å—Ç—ã –∫–æ–¥–µ–∫—Å–æ–≤ –≤ `data/codes/`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é
- [ ] –ó–∞–ø–æ–ª–Ω–∏—Ç—å `.env` —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏
- [ ] E2E-—Ç–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω–æ–π LLM

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–£–ª—É—á—à–µ–Ω–∏—è)
- [ ] –†–µ–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å kad.arbitr.ru (async)
- [ ] –£–ª—É—á—à–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ LLM
- [ ] –î–æ–±–∞–≤–∏—Ç—å few-shot –ø—Ä–∏–º–µ—Ä—ã –≤ –ø—Ä–æ–º–ø—Ç—ã
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ (Redis)
- [ ] REST API (FastAPI)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (Production)
- [ ] Dockerfile –¥–ª—è –¥–µ–ø–ª–æ—è
- [ ] CI/CD pipeline
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus + Grafana)
- [ ] Rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- [ ] Multi-tenant –ø–æ–¥–¥–µ—Ä–∂–∫–∞

## üìä –ú–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –¶–µ–ª—å |
|---------|----------|------|
| –¢–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ | 49/49 | ‚úÖ |
| –ö–µ–π—Å–æ–≤ –≤ golden set | 10 | 30+ |
| –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ | <1—Å | <5—Å ‚úÖ |
| –¢–æ—á–Ω–æ—Å—Ç—å RAG | N/A (–∑–∞–≥–ª—É—à–∫–∏) | >90% |

## üìù –ó–∞–º–µ—Ç–∫–∏

- –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞: 2026-02-20
- –§—Ä–µ–π–º–≤–æ—Ä–∫: LangGraph 0.2+
- Python: 3.11+
- LLM: Qwen 2.5 72B —á–µ—Ä–µ–∑ OpenRouter
